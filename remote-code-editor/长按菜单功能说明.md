# 长按文件夹弹出菜单功能

## 功能说明

现在可以通过长按文件夹节点快速弹出操作菜单，方便在移动设备或鼠标不便时进行文件操作。

## 使用方法

### 长按触发

1. **在文件树中找到目标文件夹**
2. **长按文件夹**（鼠标或触摸屏）
   - **鼠标**：按住左键约600毫秒（0.6秒）
   - **触摸屏**：按住约600毫秒
3. **松开后弹出菜单**

### 菜单选项

长按文件夹后会弹出包含以下选项的菜单：

#### 📁 文件夹专用菜单
- **创建文件** - 在当前文件夹下创建新文件
- **创建文件夹** - 在当前文件夹下创建新子文件夹
- **重命名** - 重命名当前文件夹
- **删除** - 删除当前文件夹及其内容

#### 📄 文件长按菜单
如果长按的是文件，菜单会在其父文件夹显示：
- **创建文件** - 在父文件夹下创建新文件
- **创建文件夹** - 在父文件夹下创建新文件夹

## 快捷对比

| 操作 | 传统方式 | 长按方式 |
|------|---------|----------|
| 创建文件 | 工具栏 → 点击"新建文件" | 长按文件夹 → 选择"创建文件" |
| 创建文件夹 | 工具栏 → 点击"新建文件夹" | 长按文件夹 → 选择"创建文件夹" |
| 重命名 | 右键 → 选择"重命名" | 长按文件夹 → 选择"重命名" |
| 删除 | 右键 → 选择"删除" | 长按文件夹 → 选择"删除" |

## 优势

### 1. 提高效率
- 无需移动鼠标到顶部工具栏
- 直接在目标文件夹位置操作
- 减少点击次数

### 2. 移动友好
- 支持触摸屏长按
- 适合平板和移动设备
- 提供统一的交互体验

### 3. 上下文感知
- 菜单始终显示在目标位置
- 明确知道要在哪个文件夹操作
- 减少操作错误

## 技术实现

### 事件处理

```javascript
// 鼠标事件
@mousedown="handleMouseDown($event, node, data)"
@mouseup="handleMouseUp"
@mouseleave="handleMouseUp"

// 触摸事件
@touchstart="handleTouchStart($event, node, data)"
@touchend="handleTouchEnd"
```

### 长按检测

```javascript
const LONG_PRESS_DURATION = 600 // 600毫秒

// 启动长按定时器
longPressTimer.value = setTimeout(() => {
  // 长按触发，显示菜单
  showLongPressMenu(event)
}, LONG_PRESS_DURATION)
```

### 智能定位

长按文件时，自动找到其父文件夹并在该位置显示菜单，确保创建操作在正确的目录下进行。

## 样式定制

### 长按延迟调整

可以修改 `LONG_PRESS_DURATION` 常量来调整长按触发时间：

```javascript
const LONG_PRESS_DURATION = 600 // 默认600ms
// 可改为：
// const LONG_PRESS_DURATION = 500  // 500ms（更快）
// const LONG_PRESS_DURATION = 800  // 800ms（更慢）
```

### 菜单样式

菜单使用 Element Plus 的 Dropdown 组件，继承暗色主题：
- 背景色：`#1e1e1e`
- 悬停色：`#2d2d2d`
- 激活色：`rgba(64, 158, 255, 0.15)`

## 兼容性

### 支持的设备
- ✅ 桌面端（鼠标）
- ✅ 平板电脑（触摸）
- ✅ 智能手机（触摸）

### 支持的浏览器
- ✅ Chrome/Edge
- ✅ Firefox
- ✅ Safari
- ✅ 移动端浏览器

## 注意事项

1. **长按时间**
   - 建议不要设置得太短，避免误触
   - 建议不要设置得太长，影响用户体验
   - 当前设置600ms是一个平衡的选择

2. **右键菜单保留**
   - 右键菜单功能仍然可用
   - 长按菜单是补充功能
   - 用户可以根据习惯选择使用

3. **移动体验**
   - 移动设备上可能更适合长按
   - 右键菜单在触摸屏上不便使用

## 未来改进建议

1. **视觉反馈**
   - 长按时显示进度指示器
   - 让用户知道即将触发菜单

2. **自定义选项**
   - 允许用户自定义长按时间
   - 允许用户禁用长按功能

3. **更多操作**
   - 添加复制/粘贴功能
   - 添加移动功能
   - 添加权限设置

4. **快捷键支持**
   - 添加键盘快捷键
   - 提高桌面端效率

---

**状态**: ✅ 已完成
**最后更新**: 2026-02-13
**测试状态**: 功能正常，支持鼠标和触摸操作
